---
title: "Homework Assignment 1"
author: "Andy Lee"
date: "2022-02-23"
output: html_document
---

```{r}
# install.packages("ggridges")
# install.packages("colorspace")
library(tidyverse)
library(lubridate)
library(ggridges)
library(ggthemes)
theme_set(theme_minimal())
library(colorspace)
```


## Question 1

![](https://bcdanl.github.io/DANL310_hw1_fig/DANL310_hw1_q1.png){width=100%}

```{r}
ncdc_temp <- read_csv(
  'https://bcdanl.github.io/data/ncdc_temp_cleaned.csv')

# Set xlabels
xlabels = c('Jan','Apr','Jul','Oct','Jan')

p <- ggplot(data = ncdc_temp)
p + geom_smooth(mapping = aes(x = date, y = temperature,color = location),se=F)+
  ylim(20,100)+
  labs(x = 'month',y='temperature(째F)')+
  scale_x_continuous(labels=xlabels)

######## Solution ########
p <- ggplot(data = ncdc_temp, mapping = aes(x = date, y = temperature,color = location))
p + geom_line(size = 1) +
  scale_x_date(breaks = ymd(c("0000-01-01", "0000-04-01", "0000-07-01", 
                              "0000-10-01", "0001-01-01")),
               labels = c('Jan','Apr','Jul','Oct','Jan'),
               limits = ymd(c("0000-01-01","0001-01-04")),
               name = "month")+
  scale_y_continuous(limits = c(20,107),
                      breaks = seq(20,100,by = 20),
                      name = "temperature (째F)") +
  theme(legend.title.align = .5)
```


## Question 2
![](https://bcdanl.github.io/DANL310_hw1_fig/DANL310_hw1_q2.png){width=100%}

```{r}
ncdc_temp <- read_csv(
  'https://bcdanl.github.io/data/ncdc_temp_cleaned.csv')

p <- ggplot(data = ncdc_temp, aes(x = month, y = temperature))

p + geom_boxplot(fill = 'lightgrey')+
  labs(y='mean temperature(째F)') +
  theme_clean()
```


## Question 3
![](https://bcdanl.github.io/DANL310_hw1_fig/DANL310_hw1_q3.png){width=100%}

```{r}
ncdc_temp <- read_csv(
  'https://bcdanl.github.io/data/ncdc_temp_cleaned.csv')


p <- ggplot(data = ncdc_temp, aes(x=temperature, y=month))
p + geom_density_ridges(alpha = 1, scale =3, bandwidth = 3.4,  fill = "skyblue",color = 'white')+
  labs(x='mean temperature(째F)')
```


## Question 4
![](https://bcdanl.github.io/DANL310_hw1_fig/DANL310_hw1_q4.png){width=100%}

```{r}
mtcars

p <- ggplot(data = mtcars, mapping = aes(x = disp, y = mpg)) 

p + geom_point(aes(color = hp, size = wt, shape = as.character(cyl)))+ 
  guides(shape = guide_legend(order = 3))+
  labs(x='displacement (cu. in.)', y = 'fuel efficiency (mpg)')+
  scale_color_gradient(low = "darkgreen", high = "lightgreen")+
  guides(shape=guide_legend(title="cylinders"),
         size = guide_legend(title='weight (1000 lbs)'))


```


## Question 5
![](https://bcdanl.github.io/DANL310_hw1_fig/DANL310_hw1_q5.png){width=100%}
```{r}
popgrowth_df <- read_csv(
  'https://bcdanl.github.io/data/popgrowth.csv')

xlabels = c('0%', '10%','20%','30%')
p <- ggplot(data = popgrowth_df, mapping = aes(x=reorder(state,popgrowth, na.rm=TRUE),y = popgrowth))

p+geom_col(position='dodge2', aes(fill = region))+
  coord_flip()+
  labs(x='reorder(state, popgrowth)', y = 'population growth, 2000 to 2010')+
  theme(legend.position = c(0.67,.4))+
  scale_y_continuous(labels = scales::percent)


```


## Question 6
![](https://bcdanl.github.io/DANL310_hw1_fig/DANL310_hw1_q6.png){width=100%}
```{r}
male_Aus <- read_csv(
  'https://bcdanl.github.io/data/aus_athletics_male.csv')

p <- ggplot(data = male_Aus, mapping = aes(x=height, y = pcBfat))

p + geom_point(aes(shape = sport, color = sport), size = 3)+
  scale_color_manual(values = c("darkred", "grey", "grey","grey","grey")) +
  scale_shape_manual(values = c(19,15,23,17,25))+
  labs(x='height (cm)', y = '% body fat')
  

```


## Question 7
![](https://bcdanl.github.io/DANL310_hw1_fig/DANL310_hw1_q7.png){width=100%}

```{r}
titanic <- read_csv(
  'https://bcdanl.github.io/data/titanic_cleaned.csv')


p <- ggplot(data = titanic, mapping=aes(x = age, y = ..count..))

p + geom_density(aes(fill = sex,),color='white')+
  scale_fill_manual(values = c("coral3","dodgerblue3", 'grey')) +
  facet_grid(~ sex, scale = "free_y")+
  geom_density(mapping = (aes(y = ..scaled..*25)),
               color='white', fill = 'grey',alpha = .4)+
  labs(x = "passenger age (years)", y = "count")+
  theme(legend.position = "bottom") +
  theme(strip.text.x = element_text(size = 15))
```


## Question 8
![](https://bcdanl.github.io/DANL310_hw1_fig/DANL310_hw1_q8.png){width=100%}
```{r}
cows_filtered <- read_csv(
  'https://bcdanl.github.io/data/cows_filtered.csv')

p <- ggplot(data = cows_filtered,
            mapping = aes(x = butterfat, fill = breed, color = breed))
p + geom_density(alpha = 0.3)+
  labs(x = 'butterfat contents')+
  scale_x_continuous(labels = scales::percent_format(scale = 1, accuracy = 1))
```

